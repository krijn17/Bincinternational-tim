<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Voorwaarden Meeting</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --ink:#111827; --muted:#1f2937; --card:#fff; --bg: radial-gradient(1200px 600px at 50% -10%, #ffffff, #f6f7fb 70%, #f0f1f5); }
    body{ margin:0; min-height:100vh; display:grid; place-items:center; padding:24px; font-family:'Montserrat',sans-serif; background:var(--bg); }
    .gd-card{ width:min(720px,92vw); background:var(--card); border-radius:16px; box-shadow:0 30px 60px rgba(16,24,40,.08), 0 2px 6px rgba(16,24,40,.06); padding:28px 28px 24px; border:1px solid #eef0f4; }
    h2{ margin:0 0 12px; font-size:clamp(20px,2.3vw,26px); font-weight:700; color:var(--ink); text-align:center; }
    .gd-lead{ margin:0 auto 20px; max-width:60ch; text-align:center; color:var(--ink); font-size:16px; line-height:1.6; }
    .gd-field{ margin:20px 0 16px }
    .gd-label{ display:block; margin:0 0 12px; color:var(--ink); font-weight:600; font-size:15px; text-align:center }
    .gd-radio-group{ display:flex; justify-content:center; gap:16px; flex-wrap:wrap }
    .gd-radio{ display:flex; align-items:center; gap:10px; border:1px solid #e5e7eb; border-radius:12px; padding:10px 16px; background:#fff; cursor:pointer; transition:box-shadow .15s,border-color .15s }
    .gd-radio input{ appearance:none; width:16px; height:16px; border:2px solid #9ca3af; border-radius:50%; position:relative }
    .gd-radio.gd-checked{ border-color:#111827; box-shadow:0 0 0 3px rgba(17,24,39,.06) }
    .gd-radio.gd-checked input{ border-color:#111827 }
    .gd-radio.gd-checked input::after{ content:""; position:absolute; inset:3px; border-radius:50%; background:#111827 }
    .gd-radio span{ font-size:15px; color:var(--ink); font-weight:600 }
    .gd-btn{ margin-top:22px; width:100%; border:none; border-radius:10px; padding:14px 18px; background:#111827; color:#fff; font-size:16px; font-weight:700; cursor:pointer; transition:transform .04s, filter .15s }
    .gd-btn:hover{ filter:brightness(1.05) } .gd-btn:active{ transform:translateY(1px) }

    /* ===== Deny full-screen (query fallback) ===== */
    .deny-wrap{ margin:0; min-height:100vh; display:grid; place-items:center; padding:24px; font-family:'Montserrat',sans-serif; background:var(--bg) }
    .deny-card{ width:min(720px,92vw); background:#fff; border-radius:16px; padding:32px 28px; border:1px solid #eef0f4; text-align:center; box-shadow:0 30px 60px rgba(16,24,40,.08),0 2px 6px rgba(16,24,40,.06) }
    .deny-card h1{ margin:6px 0 10px; font-size:clamp(20px,2.5vw,28px); color:var(--ink) }
    .deny-card p{ color:var(--muted); line-height:1.65; font-size:clamp(14px,1.8vw,16px); margin:0 auto 16px; max-width:60ch }
    .deny-card .btn{ margin-top:12px; background:#111827; color:#fff; border:none; padding:12px 16px; border-radius:10px; font-weight:700; cursor:pointer }
  </style>
</head>
<body>
  <div class="gd-card" id="gd-card">
    <h2>Voorwaarden voor deze meeting</h2>
    <p class="gd-lead">
      Wij stellen als voorwaarde dat zowel de verantwoordelijke van de
      sponsorcommissie als de verantwoordelijke van de kantine aanwezig zijn bij
      deze meeting. Alleen dan kunnen we het gesprek voeren.
    </p>

    <div class="gd-field">
      <label class="gd-label">Bij deze verklaar ik dat de <strong>verantwoordelijke van de sponsoring</strong> aanwezig is.</label>
      <div class="gd-radio-group">
        <label class="gd-radio"><input type="radio" name="sponsor" value="ja" checked><span>Ja</span></label>
        <label class="gd-radio"><input type="radio" name="sponsor" value="nee"><span>Nee</span></label>
      </div>
    </div>

    <div class="gd-field">
      <label class="gd-label">Bij deze verklaar ik dat de <strong>kantine-verantwoordelijke</strong> aanwezig is.</label>
      <div class="gd-radio-group">
        <label class="gd-radio"><input type="radio" name="kantine" value="ja" checked><span>Ja</span></label>
        <label class="gd-radio"><input type="radio" name="kantine" value="nee"><span>Nee</span></label>
      </div>
    </div>

    <button id="gd-book" class="gd-btn">Plan afspraak</button>
  </div>

  <script>
    (function(){
      const CAL_URL = 'https://cal.com/tim-van-helvoort/30min';

      // 1) Query-fallback: toon deny-scherm als ?deny=1
      const params = new URLSearchParams(location.search);
      if (params.get('deny') === '1') {
        document.body.innerHTML = `
          <div class="deny-wrap">
            <main class="deny-card">
              <h1>Afspraak plannen is niet mogelijk</h1>
              <p>Een afspraak kan alleen worden ingepland als <strong>beide</strong> verantwoordelijken aanwezig zijn:
              de verantwoordelijke van de sponsorcommissie én de kantine-verantwoordelijke.</p>
              <button class="btn" onclick="history.length ? history.back() : (location.href='${location.pathname}')">Terug</button>
            </main>
          </div>`;
        return; // stop verdere init
      }

      // 2) Mooie "checked" styling zonder :has()
      const radios = document.querySelectorAll('#gd-card .gd-radio input');
      function refresh(){
        document.querySelectorAll('#gd-card .gd-radio').forEach(l=>l.classList.remove('gd-checked'));
        document.querySelectorAll('#gd-card .gd-radio input:checked').forEach(i=>i.closest('.gd-radio')?.classList.add('gd-checked'));
      }
      radios.forEach(r=>r.addEventListener('change', refresh));
      refresh();

      function sel(n){ const el=document.querySelector(`#gd-card input[name="${n}"]:checked`); return el?el.value:null; }

      // 3) Blob-URL + fallback naar ?deny=1
      function goToDeny(){
        try {
          const html = `<!doctype html><html lang="nl"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Afspraak niet mogelijk</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  body{margin:0;display:grid;place-items:center;min-height:100vh;font-family:Montserrat,sans-serif;background:radial-gradient(1200px 600px at 50% -10%, #ffffff, #f6f7fb 70%, #f0f1f5)}
  .card{background:#fff;border-radius:16px;padding:32px 28px;max-width:720px;width:92vw;text-align:center;border:1px solid #eef0f4;
        box-shadow:0 30px 60px rgba(16,24,40,.08),0 2px 6px rgba(16,24,40,.06)}
  h1{margin:6px 0 10px;font-size:clamp(20px,2.5vw,28px);color:#111827}
  p{color:#1f2937;line-height:1.65;font-size:clamp(14px,1.8vw,16px);margin:0 auto 16px;max-width:60ch}
  .btn{margin-top:12px;background:#111827;color:#fff;border:none;padding:12px 16px;border-radius:10px;font-weight:700;cursor:pointer}
</style></head><body>
  <main class="card">
    <h1>Afspraak plannen is niet mogelijk</h1>
    <p>Een afspraak kan alleen worden ingepland als <strong>beide</strong> verantwoordelijken aanwezig zijn:
    de verantwoordelijke van de sponsorcommissie én de kantine-verantwoordelijke.</p>
    <button class="btn" onclick="history.length ? history.back() : (location.href='${location.origin}${location.pathname}')">Terug</button>
  </main>
</body></html>`;
          const blob = new Blob([html], {type:'text/html'});
          const url  = URL.createObjectURL(blob);
          window.location.href = url;
        } catch (e) {
          // Als blob navigatie ook niet mag door CSP: gebruik query fallback
          const u = new URL(location.href);
          u.searchParams.set('deny','1');
          window.location.href = u.toString();
        }
      }

      document.getElementById('gd-book').addEventListener('click', function(){
        const bothYes = (sel('sponsor')==='ja' && sel('kantine')==='ja');
        if (bothYes) window.location.href = CAL_URL;
        else goToDeny();
      });
    })();
  </script>
</body>
</html>
